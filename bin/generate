#!/usr/bin/env php
<?php

require __DIR__ . '/../../../autoload.php';

if (!defined('CONF_VIEW_THEME')) {
    $projectRoot = getcwd();
    $envFile = $projectRoot . '/.env';

    if (file_exists($envFile) && class_exists(\Dotenv\Dotenv::class)) {
        $dotenv = \Dotenv\Dotenv::createImmutable($projectRoot);
        $dotenv->load();
    }

    define('CONF_VIEW_THEME', $_ENV['CONF_VIEW_THEME'] ?? 'default');
}

$tools = new \ElxDigital\Gerador\Toolkit();
$command = $argv[1] ?? null;

match($command) {
    'map:views' => $tools->mapViews(),
    'read:fields' => $tools->scanFieldTags(),
    'generate:all' => $tools->generate(),
    default => print("Comando inv√°lido" . PHP_EOL)
};
